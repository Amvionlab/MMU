import{r as o,u as z,j as e,T as G,d as V,e as B,g as J,h as S,i as r,k as q,b as m}from"./index-DpzHKyVd.js";import{C as K}from"./index-CykP0Yyl.js";function W(){const[f,k]=o.useState(!1),{group:i,type:h,tag:c}=z(),[P,b]=o.useState([]),[T,j]=o.useState(!0),[w,D]=o.useState(null),[x,N]=o.useState(""),[p,v]=o.useState(0),[l,L]=o.useState(10),[y,R]=o.useState(""),[d,E]=o.useState("all"),u=()=>{k(!f)},I=[{label:"ID",key:"id"},{label:"Notes",key:"notes"},{label:"Date",key:"post_date"}],$=(t,s)=>{v(s)},U=t=>{L(+t.target.value),v(0)},A=decodeURIComponent(i),_=decodeURIComponent(h),C=decodeURIComponent(c);o.useEffect(()=>{const t=`${m}/backend/fetchNotes.php?action=fetch&group=${A}&type=${_}&tag=${C}`;fetch(t).then(s=>{if(!s.ok)throw new Error("Network response was not ok");return s.json()}).then(s=>{b(s),j(!1)}).catch(s=>{console.error("Error fetching data:",s),D(s.toString()),j(!1)})},[i,h,c]);const F=t=>{if(t.preventDefault(),!x.trim())return;const s={tag:c,notes:x};fetch(`${m}/backend/fetchNotes.php?action=add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(n=>n.json()).then(n=>{n.success?(N(""),u(),H()):console.error("Failed to add note:",n.error)}).catch(n=>{console.error("Error adding note:",n)})},H=()=>{const t=decodeURIComponent(i),s=decodeURIComponent(h),n=decodeURIComponent(c),O=`${m}/backend/fetchNotes.php?action=fetch&group=${t}&type=${s}&tag=${n}`;fetch(O).then(a=>{if(!a.ok)throw new Error("Network response was not ok");return a.json()}).then(a=>{b(a)}).catch(a=>{console.error("Error fetching data:",a)})},g=P.filter(t=>{const s=y.toLowerCase();return d==="all"?t.id.toString().toLowerCase().includes(s)||t.notes.toLowerCase().includes(s)||new Date(t.post_date).toLocaleString().toLowerCase().includes(s):d==="post_date"?new Date(t[d]).toLocaleString().toLowerCase().includes(s):t[d].toString().toLowerCase().includes(s)});return T?e.jsx("div",{children:"Loading..."}):w?e.jsxs("div",{children:["Error fetching data: ",w]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex font-bold justify-between items-center mb-3",children:[e.jsx("h1",{className:"text-xl ",children:"Asset Notes"}),e.jsxs("button",{className:"flex text-xs items-center px-3 py-2 bg-box border border-gray-400 shadow-inner text-prime rounded hover:shadow-md hover:border-prime transition-transform transform hover:scale-110",onClick:u,children:[e.jsx("span",{children:" + "})," Add Note"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex font-medium",children:[e.jsxs("select",{value:d,className:"text-xs border p-2 mr-2 rounded-md",onChange:t=>E(t.target.value),style:{height:"30px"},children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"id",children:"ID"}),e.jsx("option",{value:"notes",children:"Notes"}),e.jsx("option",{value:"post_date",children:"Date"})]}),e.jsx("input",{type:"text",id:"search-bar",placeholder:"Search",className:"text-xs border p-2 rounded-md",value:y,onChange:t=>R(t.target.value),style:{height:"30px",width:"100px"}})]}),e.jsx(G,{rowsPerPageOptions:[10,25,100,500],component:"div",count:g.length,rowsPerPage:l,page:p,onPageChange:$,onRowsPerPageChange:U}),e.jsx(K,{data:g,headers:I,filename:`asset-notes-${C}.csv`,className:"flex text-xs items-center px-3 py-1 bg-box border border-gray-400 font-bold shadow-inner text-prime rounded hover:shadow-md hover:border-prime transition-transform transform hover:scale-110",children:"CSV"})]}),f&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"bg-black bg-opacity-50 absolute inset-0"}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg z-10 w-96",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Add a New Note"}),e.jsxs("form",{onSubmit:F,children:[e.jsx("div",{className:"mb-4",children:e.jsx("textarea",{className:"w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:border-prime",rows:"4",placeholder:"Enter description here...",value:x,onChange:t=>N(t.target.value)})}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",className:"bg-gray-500 text-white px-4 py-2 rounded-md mr-2",onClick:u,children:"Cancel"}),e.jsx("button",{type:"submit",className:"bg-prime text-white px-4 py-2 rounded-md",children:"Save Note"})]})]})]})]}),e.jsx(V,{sx:{maxHeight:440},children:e.jsxs(B,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(J,{children:e.jsxs(S,{children:[e.jsx(r,{align:"center",children:"ID"}),e.jsx(r,{align:"center",children:"Notes"}),e.jsx(r,{align:"center",children:"Date"})]})}),e.jsx(q,{sx:{padding:"2px"},children:g.slice(p*l,p*l+l).map(t=>e.jsxs(S,{hover:!0,role:"checkbox",tabIndex:-1,className:"text-xs",children:[e.jsx(r,{align:"center",sx:{padding:"10px"},children:t.id}),e.jsx(r,{align:"center",sx:{padding:"10px"},children:t.notes}),e.jsx(r,{align:"center",sx:{padding:"10px"},children:new Date(t.post_date).toLocaleString()})]},t.id))})]})})]})}export{W as default};
